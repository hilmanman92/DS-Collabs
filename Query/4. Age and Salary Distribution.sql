-- age distribution based on gender
SELECT
    Gender,
    COUNT(Gender) AS Total,
    SUM(CASE WHEN Age BETWEEN 15 AND 19 THEN 1 ELSE 0 END) AS [15-19],
    SUM(CASE WHEN Age BETWEEN 20 AND 24 THEN 1 ELSE 0 END) AS [20-24],
    SUM(CASE WHEN Age BETWEEN 25 AND 29 THEN 1 ELSE 0 END) AS [25-29],
    SUM(CASE WHEN Age BETWEEN 30 AND 34 THEN 1 ELSE 0 END) AS [30-34],
    SUM(CASE WHEN Age BETWEEN 35 AND 39 THEN 1 ELSE 0 END) AS [35-39],
    SUM(CASE WHEN Age BETWEEN 40 AND 44 THEN 1 ELSE 0 END) AS [40-44],
    SUM(CASE WHEN Age BETWEEN 45 AND 49 THEN 1 ELSE 0 END) AS [45-49],
    SUM(CASE WHEN Age BETWEEN 50 AND 54 THEN 1 ELSE 0 END) AS [50-54],
    SUM(CASE WHEN Age BETWEEN 55 AND 59 THEN 1 ELSE 0 END) AS [55-59],
    SUM(CASE WHEN Age >= 60 THEN 1 ELSE 0 END) AS [60+]
FROM
    EmployeeAttrition
GROUP BY
    Gender;

-- salary distribution based on overtime
SELECT
    OverTime,
    COUNT(*) AS Total,
    SUM(CASE WHEN MonthlyIncome BETWEEN 1000 AND 3000 THEN 1 ELSE 0 END) AS [15-19],
    SUM(CASE WHEN MonthlyIncome BETWEEN 3000 AND 5000 THEN 1 ELSE 0 END) AS [3K-5K],
    SUM(CASE WHEN MonthlyIncome BETWEEN 5000 AND 7000 THEN 1 ELSE 0 END) AS [5K-7K],
    SUM(CASE WHEN MonthlyIncome BETWEEN 7000 AND 9000 THEN 1 ELSE 0 END) AS [30-9K],
    SUM(CASE WHEN MonthlyIncome BETWEEN 9000 AND 11000 THEN 1 ELSE 0 END) AS [35-11K],
    SUM(CASE WHEN MonthlyIncome BETWEEN 11000 AND 13000 THEN 1 ELSE 0 END) AS [40-13K],
    SUM(CASE WHEN MonthlyIncome BETWEEN 13000 AND 15000 THEN 1 ELSE 0 END) AS [45-15K],
    SUM(CASE WHEN MonthlyIncome BETWEEN 15000 AND 17000 THEN 1 ELSE 0 END) AS [50-17K],
    SUM(CASE WHEN MonthlyIncome BETWEEN 17000 AND 19000 THEN 1 ELSE 0 END) AS [55-19K],
    SUM(CASE WHEN MonthlyIncome >= 19000 THEN 1 ELSE 0 END) AS [19K+]
FROM
    EmployeeAttrition
GROUP BY
    OverTime;